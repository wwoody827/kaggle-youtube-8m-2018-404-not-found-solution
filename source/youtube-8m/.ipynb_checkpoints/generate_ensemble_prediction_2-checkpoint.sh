# 0620_gatednetvladLF-256-1024-80-0002-300iter-norelu-basic-gatedmoe, 172700, Avg_Hit@1: 0.895 | Avg_PERR: 0.809 | MAP: 0.538 | GAP: 0.865 | Avg_Loss: 3.664083

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord  --model=NetVLADModelLF --train_dir=run/0620_gatednetvladLF-256-1024-80-0002-300iter-norelu-basic-gatedmoe --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=160 --base_learning_rate=0.0002 --netvlad_cluster_size=256 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True  --export_model_steps=20000 --num_epochs=10 --run_once=True --output_dir=prediction_val/0620_gatednetvladLF-256-1024-80-0002-300iter-norelu-basic-gatedmoe/ --file_size=4000 


# 0621_gatednetvladLF-128-1024-160-0002-300iter-norelu-basic-gatedmoe, 120307 | Avg_Hit@1: 0.894 | Avg_PERR: 0.808 | MAP: 0.537 | GAP: 0.865 | Avg_Loss: 3.658021

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord  --model=NetVLADModelLF --train_dir=run/0621_gatednetvladLF-128-1024-160-0002-300iter-norelu-basic-gatedmoe --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=160 --base_learning_rate=0.0002 --netvlad_cluster_size=128 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True  --export_model_steps=20000 --num_epochs=10 --run_once=True --output_dir=prediction_val/0621_gatednetvladLF-128-1024-160-0002-300iter-norelu-basic-gatedmoe --file_size=4000

# 0622_gatednetvladLF-64-1024-160-0002-300iter-norelu-basic-gatedmoe, 98340 | Avg_Hit@1: 0.893 | Avg_PERR: 0.807 | MAP: 0.534 | GAP: 0.864 | Avg_Loss: 3.654183

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord  --model=NetVLADModelLF --train_dir=run/0622_gatednetvladLF-64-1024-160-0002-300iter-norelu-basic-gatedmoe --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=160 --base_learning_rate=0.0002 --netvlad_cluster_size=64 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True  --export_model_steps=20000 --num_epochs=10 --run_once=True --output_dir=prediction_val/0622_gatednetvladLF-64-1024-160-0002-300iter-norelu-basic-gatedmoe/ --file_size=4000


# 0622_gatednetfvLF-128k-1024-60-0002-300iter-norelu-basic-gatedmoe, 207517 | Avg_Hit@1: 0.891 | Avg_PERR: 0.806 | MAP: 0.546 | GAP: 0.863 | Avg_Loss: 3.710609

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord  --model=NetFVModelLF --train_dir=run/0622_gatednetfvLF-128k-1024-60-0002-300iter-norelu-basic-gatedmoe --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=80 --base_learning_rate=0.0002 --fv_cluster_size=128 --fv_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --fv_relu=False --gating=True --moe_prob_gating=True --fv_couple_weights=False --max_step=600000  --export_model_steps=20000 --num_epochs=10 --run_once=True  --output_dir=prediction_val/0622_gatednetfvLF-128k-1024-60-0002-300iter-norelu-basic-gatedmoe/ --file_size=4000

# 0626_gatednetvladLF-128-1024-80-0002-300iter-norelu-basic-DeepCombineChainModel

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord --model=NetVLADModelLF --video_level_classifier_model=DeepCombineChainModel --train_dir=run/0626_gatednetvladLF-128-1024-80-0002-300iter-norelu-basic-DeepCombineChainModel --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=80 --base_learning_rate=0.0002 --netvlad_cluster_size=128 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True  --export_model_steps=200000 --num_epochs=10 --run_once=True  --output_dir=prediction_val/0626_gatednetvladLF-128-1024-80-0002-300iter-norelu-basic-DeepCombineChainModel/ --file_size=4000


# 0627_gatednetvladLF-128-1024-80-0002-4chain-300iter-norelu-basic-DeepCombineChainModel

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord --model=NetVLADModelLF --video_level_classifier_model=DeepCombineChainModel --train_dir=run/0627_gatednetvladLF-128-1024-80-0002-4chain-300iter-norelu-basic-DeepCombineChainModel --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=80 --base_learning_rate=0.0002 --netvlad_cluster_size=128 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True --deep_chain_layers=4 --export_model_steps=200000 --num_epochs=10 --run_once=True  --output_dir=prediction_val/0627_gatednetvladLF-128-1024-80-0002-4chain-300iter-norelu-basic-DeepCombineChainModel/ --file_size=4000

# 0628_gatednetvladLF-128-1024-40-0002-4chain-256cells-300iter-norelu-basic-DeepCombineChainModel

# CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord --model=NetVLADModelLF --video_level_classifier_model=DeepCombineChainModel --train_dir=run/0628_gatednetvladLF-128-1024-40-0002-4chain-256cells-300iter-norelu-basic-DeepCombineChainModel --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=40 --base_learning_rate=0.0002 --netvlad_cluster_size=128 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True --deep_chain_layers=4 --deep_chain_relu_cells=256 --export_model_steps=200000 --num_epochs=10 --run_once=True --output_dir=prediction_val/0628_gatednetvladLF-128-1024-40-0002-4chain-256cells-300iter-norelu-basic-DeepCombineChainModel/ --file_size=4000

# 0624_gatedlightvladLF-256k-1024-80-0002-300iter-norelu-basic-gatedmoe
CUDA_VISIBLE_DEVICES=0 python eval_predicition.py --eval_data_pattern=/media/woody/SSD/home/woody/val/validate1*.tfrecord  --model=NetFVModelLF --train_dir=run/0624_gatedlightvladLF-256k-1024-80-0002-300iter-norelu-basic-gatedmoe --frame_features=True --feature_names="rgb,audio" --feature_sizes="1024,128" --batch_size=80 --base_learning_rate=0.0002 --netvlad_cluster_size=256 --netvlad_hidden_size=1024 --moe_l2=1e-6 --iterations=300 --learning_rate_decay=0.8 --netvlad_relu=False --gating=True --moe_prob_gating=True --lightvlad=True --max_step=600000  --export_model_steps=20000 --num_epochs=10 --run_once=True --output_dir=prediction_val/0624_gatedlightvladLF-256k-1024-80-0002-300iter-norelu-basic-gatedmoe/ --file_size=4000
